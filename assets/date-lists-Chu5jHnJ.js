import{r as i,j as t,d as D,F as E,i as C,c as L,R as P,e as B,T as F,b as W,f as A,h as q,k as M,l as V,m as Q,L as U,n as z}from"./index-De34_xs9.js";import{C as G,a as J,H as K}from"./history-nav-duMeTCtY.js";import{u as I}from"./useTranslation-CmejgiFJ.js";const O=e=>{const{t:s}=I("date-lists"),l=i.useRef(!1),o=(n,u)=>{if(n.preventDefault(),!(e.dateInput&&e.dateInput.current))return;let r="";if(["plus_day","plus_month"].includes(u.type)){const f=u.type.split("_");r=D(u.value,f[1],e.dateInput.current.value)}else r=D(u.value,u.type);l.current=!0,e.dateInput.current.value=r,e.dateInput.current.focus(),e.setDate(r)};e.dateInput&&e.dateInput.current&&e.dateInput.current.addEventListener("focus",n=>{l.current===!0&&n.preventDefault(),l.current=!1});const a=[{value:0,type:"day",i18n:s("intlRelativeTime-day-auto",{val:0})},{value:1,type:"day",i18n:s("intlRelativeTime-day",{val:1})},{value:2,type:"day",i18n:s("day-WithCount_other",{count:2})}];for(let n=3;n<15;n++)a.push({value:n,type:"day",i18n:n});a.push.apply(a,[{value:1,type:"plus_day",i18n:s("plus-day-WithCount_one",{count:1})},{value:7,type:"plus_day",i18n:s("plus-day-WithCount_other",{count:7})},{value:1,type:"month",i18n:s("intlRelativeTime-month",{val:1})},{value:2,type:"month",i18n:s("month-WithCount_other",{count:2})},{value:3,type:"month",i18n:3},{value:4,type:"month",i18n:4},{value:5,type:"month",i18n:5},{value:6,type:"month",i18n:6},{value:1,type:"plus_month",i18n:s("plus-month-WithCount_one",{count:1})}]);let c=[],d="day";return a.forEach((n,u)=>{const r=n.type;r!==d&&!r.includes("plus")&&(c.push(t.jsx("br",{},"br"+u)),d=r),c.push(t.jsx("button",{type:"button",onClick:f=>o(f,n),className:"btn btn-outline-dark",children:n.i18n},u))}),t.jsx("div",{className:"date-buttons",children:t.jsxs("details",{children:[t.jsxs("summary",{className:"form-label",children:[" ",s("pick-a-date")]}),t.jsx("small",{id:"date-buttons-help",className:"form-text text-muted",children:s("quickly-pick-a-date-with-the-buttons-below")}),c]})})},X=e=>{const s=E(e.date,e.settings.settings),l=e.settings.settings.pastDateColor,o=e.settings.settings.usePastDateColor,a=e.dateType==="past";let c={};a&&o&&C(l)&&(c={color:l});const d=e.settings.settings.todayDateColor,n=e.settings.settings.useTodayDateColor;return e.dateType==="today"&&n&&C(d)&&(c={color:d}),t.jsx("div",{className:"list-item-date",style:c,children:s})},Y=e=>{const s=L(),{t:l}=I("date-lists"),o=c=>{s(B({ids:[e.item.id],type:e.settings.type}))};let a="";return e.settings.settings.usePastDateColor&&(a=P(e.item.date)),t.jsxs("li",{className:"list-group-item "+a,ref:e.newListItem,children:[t.jsxs("div",{className:"list-item",children:[t.jsx("div",{className:"list-item-text",children:e.item.text}),t.jsx(X,{date:e.item.date,settings:e.settings,dateType:a})]}),t.jsx("button",{type:"button",className:"delete-item",tabIndex:0,"aria-label":l("delete-list-item"),onClick:o})]},e.item.id)},Z=e=>{const s=e.listItems.length;return t.jsx("ul",{className:"list-group list-group-flush",children:s>0&&e.listItems.map(l=>t.jsx(Y,{item:l,settings:e.settings,newListItem:l.id===e.latestListItemID?e.newListItem:null},l.id))})},st=()=>{const e=L(),{t:s}=I("date-lists"),[l,o]=i.useState(""),a=i.useContext(F),c=a.type,d=W(y=>y.lists),n=A(c,d),u=q(n),r=n.length,f=window.matchMedia("(prefers-reduced-motion: reduce)"),R=!f||f.matches?"instant":"smooth",T=i.useRef(R),p=i.useRef(!1),x=i.useRef(!1),v=i.useRef(null),m=i.useRef(null),h=i.useRef(null),N=i.useRef(null),w=i.useRef(null),j=i.useRef(null),k={collapseLink:w,listItemInput:v,container:N},b=M(n),{historyState:g,setHistory:_}=b;i.useEffect(()=>{x.current&&(e(V({type:c,items:g})),x.current=!1)},[g.length]),i.useEffect(()=>{g.length!==r&&_(n),p.current&&h.current!==null&&(h.current.scrollIntoView({behavior:T.current}),h.current.classList.add("new-list-item"),setTimeout(function(){h.current!==null&&h.current.classList.remove("new-list-item"),h.current=null},1e3)),p.current=!1},[r]);const S=y=>{y.preventDefault(),v.current&&m.current?(e(z({type:c,item:{id:0,text:v.current.value,date:m.current.value}})),v.current.value="",m.current.value="",p.current=!0):alert(s("invalid-list-item-try-again"))},H=y=>{y(),x.current=!0};return i.useEffect(()=>{!m.current||!j.current||(j.current.innerHTML=Q(m.current.value))},[l]),t.jsx(G.Provider,{value:k,children:t.jsxs("div",{className:"date-lists",children:[t.jsx("div",{className:"list-item-form",children:t.jsxs("form",{className:"app-form",onSubmit:S,children:[t.jsx("h1",{children:a.title}),a.description&&t.jsx("p",{className:"type-desc",children:a.description}),t.jsxs("ul",{className:"nav sub-navigation",children:[t.jsx("li",{className:"nav-item",children:t.jsx(U,{className:"nav-link nav-settings",to:"/settings?type="+c,children:s("settings")})}),t.jsx("li",{children:t.jsx(J,{listItemCount:r})})]}),t.jsxs("div",{className:"form-group collapse",id:"form-collapse",ref:N,children:[t.jsxs("div",{className:"form-section",children:[t.jsx("label",{htmlFor:"list-item-text",className:"form-label",children:s("list-item")}),t.jsx("input",{type:"text",id:"list-item-text",className:"form-control",name:"listItemText",ref:v,required:!0})]}),t.jsxs("div",{className:"form-section",children:[t.jsx("label",{htmlFor:"list-item-date",className:"form-label",children:s("list-item-date")}),t.jsxs("div",{className:"date-container",children:[t.jsx("input",{type:"date",id:"list-item-date",className:"form-control",name:"listItemDate",ref:m,onChange:y=>o(y.target.value),required:!0}),t.jsx("p",{className:"date-preview",ref:j})]})]}),t.jsx("div",{className:"form-section",children:t.jsx(O,{dateInput:m,setDate:o})}),t.jsx("div",{className:"form-section",children:t.jsx("button",{type:"submit",className:"btn btn-success",children:s("add-list-item")})})]})]})}),t.jsx("div",{className:"list-nav",children:t.jsx(K,{updateHistory:H,history:b})}),t.jsx(Z,{listType:c,settings:a,listItems:n,newListItem:h,latestListItemID:u}),r===0&&t.jsx("p",{children:s("there-are-no-list-items-yet")})]})})};export{st as default};
