import{j as t,d as D,F as E,i as C,c as L,R as P,e as F,r as l,T as W,b as B,f as q,h as A,k as M,l as V,m as Q,L as U,n as z}from"./index-oD98G8_M.js";import{C as G,a as J,H as K}from"./history-nav-JH-FKn-z.js";import{u as g}from"./useTranslation-yV2ZmWrD.js";const O=e=>{const{t:s}=g("date-lists"),r=(n,a)=>{if(n.preventDefault(),!(e.dateInput&&e.dateInput.current))return;let u="";if(["plus_day","plus_month"].includes(a.type)){const d=a.type.split("_");u=D(a.value,d[1],e.dateInput.current.value)}else u=D(a.value,a.type);e.dateInput.current.value=u,e.dateInput.current.focus(),e.setDate(u)},o=[{value:0,type:"day",i18n:s("intlRelativeTime-day-auto",{val:0})},{value:1,type:"day",i18n:s("intlRelativeTime-day",{val:1})},{value:2,type:"day",i18n:s("day-WithCount_other",{count:2})}];for(let n=3;n<15;n++)o.push({value:n,type:"day",i18n:n});o.push.apply(o,[{value:1,type:"plus_day",i18n:s("plus-day-WithCount_one",{count:1})},{value:7,type:"plus_day",i18n:s("plus-day-WithCount_other",{count:7})},{value:1,type:"month",i18n:s("intlRelativeTime-month",{val:1})},{value:2,type:"month",i18n:s("month-WithCount_other",{count:2})},{value:3,type:"month",i18n:3},{value:4,type:"month",i18n:4},{value:5,type:"month",i18n:5},{value:6,type:"month",i18n:6},{value:1,type:"plus_month",i18n:s("plus-month-WithCount_one",{count:1})}]);let i=[],c="day";return o.forEach((n,a)=>{const u=n.type;u!==c&&!u.includes("plus")&&(i.push(t.jsx("br",{},"br"+a)),c=u),i.push(t.jsx("button",{type:"button",onClick:d=>r(d,n),className:"btn btn-outline-dark",children:n.i18n},a))}),t.jsx("div",{className:"date-buttons",children:t.jsxs("details",{children:[t.jsxs("summary",{className:"form-label",children:[" ",s("pick-a-date")]}),t.jsx("small",{id:"date-buttons-help",className:"form-text text-muted",children:s("quickly-pick-a-date-with-the-buttons-below")}),i]})})},X=e=>{const s=E(e.date,e.settings.settings),r=e.settings.settings.pastDateColor,o=e.settings.settings.usePastDateColor,i=e.dateType==="past";let c={};i&&o&&C(r)&&(c={color:r});const n=e.settings.settings.todayDateColor,a=e.settings.settings.useTodayDateColor;return e.dateType==="today"&&a&&C(n)&&(c={color:n}),t.jsx("div",{className:"list-item-date",style:c,children:s})},Y=e=>{const s=L(),{t:r}=g("date-lists"),o=c=>{s(F({ids:[e.item.id],type:e.settings.type}))};let i="";return e.settings.settings.usePastDateColor&&(i=P(e.item.date)),t.jsxs("li",{className:"list-group-item "+i,ref:e.newListItem,children:[t.jsxs("div",{className:"list-item",children:[t.jsx("div",{className:"list-item-text",children:e.item.text}),t.jsx(X,{date:e.item.date,settings:e.settings,dateType:i})]}),t.jsx("button",{type:"button",className:"delete-item",tabIndex:0,"aria-label":r("delete-list-item"),onClick:o})]},e.item.id)},Z=e=>{const s=e.listItems.length;return t.jsx("ul",{className:"list-group list-group-flush",children:s>0&&e.listItems.map(r=>t.jsx(Y,{item:r,settings:e.settings,newListItem:r.id===e.latestListItemID?e.newListItem:null},r.id))})},st=()=>{const e=L(),{t:s}=g("date-lists"),[r,o]=l.useState(""),i=l.useContext(W),c=i.type,n=B(y=>y.lists),a=q(c,n),u=A(a),d=a.length,I=window.matchMedia("(prefers-reduced-motion: reduce)"),T=!I||I.matches?"instant":"smooth",R=l.useRef(T),p=l.useRef(!1),v=l.useRef(!1),f=l.useRef(null),m=l.useRef(null),h=l.useRef(null),N=l.useRef(null),w=l.useRef(null),x=l.useRef(null),k={collapseLink:w,listItemInput:f,container:N},b=M(a),{historyState:j,setHistory:_}=b;l.useEffect(()=>{v.current&&(e(V({type:c,items:j})),v.current=!1)},[j.length]),l.useEffect(()=>{j.length!==d&&_(a),p.current&&h.current!==null&&(h.current.scrollIntoView({behavior:R.current}),h.current.classList.add("new-list-item"),setTimeout(function(){h.current!==null&&h.current.classList.remove("new-list-item"),h.current=null},1e3)),p.current=!1},[d]);const S=y=>{y.preventDefault(),f.current&&m.current?(e(z({type:c,item:{id:0,text:f.current.value,date:m.current.value}})),f.current.value="",m.current.value="",p.current=!0):alert(s("invalid-list-item-try-again"))},H=y=>{y(),v.current=!0};return l.useEffect(()=>{!m.current||!x.current||(x.current.innerHTML=Q(m.current.value))},[r]),t.jsx(G.Provider,{value:k,children:t.jsxs("div",{className:"date-lists",children:[t.jsx("div",{className:"list-item-form",children:t.jsxs("form",{className:"app-form",onSubmit:S,children:[t.jsx("h1",{children:i.title}),i.description&&t.jsx("p",{className:"type-desc",children:i.description}),t.jsxs("ul",{className:"nav sub-navigation",children:[t.jsx("li",{className:"nav-item",children:t.jsx(U,{className:"nav-link nav-settings",to:"/settings?type="+c,children:s("settings")})}),t.jsx("li",{children:t.jsx(J,{listItemCount:d})})]}),t.jsxs("div",{className:"form-group collapse",id:"form-collapse",ref:N,children:[t.jsxs("div",{className:"form-section",children:[t.jsx("label",{htmlFor:"list-item-text",className:"form-label",children:s("list-item")}),t.jsx("input",{type:"text",id:"list-item-text",className:"form-control",name:"listItemText",ref:f,required:!0})]}),t.jsxs("div",{className:"form-section",children:[t.jsx("label",{htmlFor:"list-item-date",className:"form-label",children:s("list-item-date")}),t.jsxs("div",{className:"date-container",children:[t.jsx("input",{type:"date",id:"list-item-date",className:"form-control",name:"listItemDate",ref:m,onChange:y=>o(y.target.value),required:!0}),t.jsx("p",{className:"date-preview",ref:x})]})]}),t.jsx("div",{className:"form-section",children:t.jsx(O,{dateInput:m,setDate:o})}),t.jsx("div",{className:"form-section",children:t.jsx("button",{type:"submit",className:"btn btn-success",children:s("add-list-item")})})]})]})}),t.jsx("div",{className:"list-nav",children:t.jsx(K,{updateHistory:H,history:b})}),t.jsx(Z,{listType:c,settings:i,listItems:a,newListItem:h,latestListItemID:u}),d===0&&t.jsx("p",{children:s("there-are-no-list-items-yet")})]})})};export{st as default};
